<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>房地产价格时空分析</title>
    <style>
        body {
            padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
        }
    </style>

    <link rel="stylesheet" href="/view/生态文明/lib/leaflet/leaflet.css" />
    <!--<link href="/view/生态文明/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">-->
    <link href="/view/生态文明/stylesheets/ui.css" rel="stylesheet">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/view/生态文明/sidebar-v2-master/css/leaflet-sidebar.css" />
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">

    <script type="text/javascript" src="/view/生态文明/lib/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="/view/生态文明/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="lib/leaflet/leaflet.js"></script>
    <script type="text/javascript" src="/view/dist/leaflet-dvf.js"></script>
    <script type="text/javascript" src="/view/生态文明/sidebar-v2-master/js/jquery-sidebar.min.js"></script>
    <script type="text/javascript" src="/view/生态文明/sidebar-v2-master/js/leaflet-sidebar.min.js"></script>



    <script type="text/javascript" src='/view/生态文明/lib/leaflet/leaflet.ChineseTmsProviders.js'></script>
    <script src="/view/生态文明/Chart.js-2.1.6/dist/Chart.bundle.js"></script>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <style>.legend i{
      height: 18px;
      width:18px;
      float: left;
      margin-right: 8px;
    }</style>

    <!--表格table的样式设计模板-->
    <style type="text/css">
        table{
            font-family: verdana,arial,sans-serif;
            font-size:11px;
            color:#333333;
            border-width: 10px;
            border-color: #377199;
            border-collapse: collapse;
            border-style: solid;
        }
        /*设置表格标题的样式*/
        table caption{
            text-align:center;
            font-family : 楷体;
            font-size : 1.5em;
            color:#4B0082;
        }
        /*设置表的字段属性*/
        table th{
            background-color:#FFE4B5;
            border-width: 10px;
            padding: 8px;
            border-style: solid;
            border-color: #a9c6c9;
            font-size : 2em;
            font-family : 楷体;
        }
        table tr{
            background-color:#C6E2FF;/*#d4e3e5*/
        }
        /*设置单元格的属性*/
        table td{
            border-width: 10px;
            padding: 8px;
            border-style: solid;
            border-color: #a9c6c9;
            font-size : 2em;
        }
    </style>

</head>
<body>

<div class="navbar navbar-default">
    <div class="navbar-inner">
        <h1 style="text-align:center;">北京房地产时空大数据分析</h1>
        <div class="container">
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li class="active">中国科学院地理科学与资源研究所</li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </div>
</div>


<div class="container-fluid">
    <div class="row-fluid">

        <div id="sidebar" class="sidebar collapsed">
            <!-- Nav tabs -->
            <div class="sidebar-tabs">
                <ul role="tablist">
                    <li>
                        <a href="#home" role="tab">
                            <span class="glyphicon glyphicon-align-center"></span>
                        </a>
                    </li>
                    <li>
                        <a href="#profile" role="tab">
                            <span class="glyphicon glyphicon-align-justify"></span>
                        </a>
                    </li>
                    <li>
                        <a href="#messages" role="tab">
                            <span class="glyphicon glyphicon-map-marker"></span>
                        </a>
                    </li>
                    <li>
                        <a href="#grid50" role="tab">
                            <span class="glyphicon glyphicon-th-large"></span>
                        </a>
                    </li>
                </ul>

                <ul role="tablist">
                    <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
                </ul>
            </div>

            <!-- Tab panes -->
            <div class="sidebar-content">
                <div class="sidebar-pane" id="home">

                    <h1 class="sidebar-header">
                        原始数据
                        <span class="sidebar-close"><i class="fa fa-caret-right"></i></span>

                    </h1>

                    <!--下拉列表-->
                    <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="source" class="col-sm-4 control-label">数据来源</label>
                        <select id="source" class ="form-control" style='width:200px;'>
                            <option>请选择</option>
                            <option>我爱我家</option>
                            <option>房天下</option>
                            <option>安居客</option>
                            <option>链家</option>
                            <option>全部</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="type" class="col-sm-4 control-label">房源类型</label>
                        <select id="type" class ="form-control" style='width:200px;'>
                            <option>请选择</option>
                            <option>新房</option>
                            <option>二手房</option>
                            <option>租房</option>
                            <option>求租</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="gridValue" class="col-sm-4 control-label">网格颜色意义</label>
                        <select id="gridValue" style='width:200px;'>
                            <option>请选择</option>
                            <option>房价加速度</option>
                            <option>房价</option>
                            <option>投资价格</option>
                        </select>
                    </div>
                    </form>

                    <!--标签栏-->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#price" role="tab" data-toggle="tab">房价</a></li>
                        <li role="presentation"><a href="#acceleration" role="tab" data-toggle="tab">房价加速度</a></li>
                        <li role="presentation"><a href="#invest" role="tab" data-toggle="tab">投资价格</a></li>
                    </ul>
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="price">
                            <form class="form-horizontal" role="form">
                                <div class="form-group">
                                    <label for="gridTime" class="col-sm-4 control-label">网格房价时间</label>
                                    <select id="gridTime" style='width:200px;'>
                                        <option>请选择</option>
                                        <option id="201507">2015年07月</option>
                                        <option id="201508">2015年08月</option>
                                        <option id="201509">2015年09月</option>
                                        <option id="201510">2015年10月</option>
                                        <option id="201511">2015年11月</option>
                                        <option id="201512">2015年12月</option>
                                        <option id="201601">2016年01月</option>
                                        <option id="201602">2016年02月</option>
                                        <option id="201603">2016年03月</option>
                                        <option id="201604">2016年04月</option>
                                        <option id="201605">2016年05月</option>
                                        <option id="201606">2016年06月</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="acceleration">
                            <form class="form-horizontal" role="form">
                                <div class="form-group">
                                    <label for="startTime" class="col-sm-4 control-label">加速度起始时间</label>
                                    <select id="startTime" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>2015年07月</option>
                                        <option>2015年08月</option>
                                        <option>2015年09月</option>
                                        <option>2015年10月</option>
                                        <option>2015年11月</option>
                                        <option>2015年12月</option>
                                        <option>2016年01月</option>
                                        <option>2016年02月</option>
                                        <option>2016年03月</option>
                                        <option>2016年04月</option>
                                        <option>2016年05月</option>
                                        <option>2016年06月</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="endTime" class="col-sm-4 control-label">加速度终止时间</label>
                                    <select id="endTime" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>2015年07月</option>
                                        <option>2015年08月</option>
                                        <option>2015年09月</option>
                                        <option>2015年10月</option>
                                        <option>2015年11月</option>
                                        <option>2015年12月</option>
                                        <option>2016年01月</option>
                                        <option>2016年02月</option>
                                        <option>2016年03月</option>
                                        <option>2016年04月</option>
                                        <option>2016年05月</option>
                                        <option>2016年06月</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="computation" class="col-sm-4 control-label">加速度计算方式</label>
                                    <select id="computation" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>最值计算法</option>
                                        <option>起止时间计算法</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="invest">
                            <form class="form-horizontal" role="form">
                                <div class="form-group">
                                    <label for="gridTime_invest" class="col-sm-4 control-label">投资时间</label>
                                    <select id="gridTime_invest" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>2015年07月</option>
                                        <option>2015年08月</option>
                                        <option>2015年09月</option>
                                        <option>2015年10月</option>
                                        <option>2015年11月</option>
                                        <option>2015年12月</option>
                                        <option>2016年01月</option>
                                        <option>2016年02月</option>
                                        <option>2016年03月</option>
                                        <option>2016年04月</option>
                                        <option>2016年05月</option>
                                        <option>2016年06月</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="computation_invest" class="col-sm-4 control-label">投资额计算方法</label>
                                    <select id="computation_invest" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>总价加权</option>
                                        <option>均价加权</option>
                                    </select>
                                </div>

                            </form>
                        </div>

                    </div>

                    <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="finish" class="col-sm-4 control-label">是否完成选择</label>
                        <select id="finish" class ="form-control" style='width:200px;'>
                            <option>请选择</option>
                            <option>是</option>
                            <option>否</option>
                        </select>
                    </div>
                </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="delect" class="col-sm-4 control-label">是否取消当前选择</label>
                            <select id="delect" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>是</option>
                                <option>否</option>
                            </select>
                        </div>
                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="investment" class="col-sm-4 control-label">投资门槛计算方式</label>
                            <select id="investment" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>总价加权</option>
                                <option>均价加权</option>
                            </select>
                        </div>
                    </form>

                </div>

                <div class="sidebar-pane" id="profile">
                    <h1 class="sidebar-header">
                        插值数据
                        <span class="sidebar-close"><i class="fa fa-caret-right"></i></span>
                    </h1>
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="chazhi" class="col-sm-4 control-label">是否显示插值数据</label>
                            <select id="chazhi" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>否</option>
                                <option>是</option>
                            </select>
                        </div>

                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="contourline" class="col-sm-4 control-label">是否显示等值线</label>
                            <select id="contourline" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>否</option>
                                <option>是</option>
                            </select>
                        </div>

                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="contourvalue" class="col-sm-4 control-label">选择等值线范围</label>
                            <select id="contourvalue" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>2万以下</option>
                                <option>2万——3万</option>
                                <option>3万——4万</option>
                                <option>4万——5万</option>
                                <option>5万——6万</option>
                                <option>6万——7万</option>
                                <option>7万——8万</option>
                                <option>8万——9万</option>
                                <option>9万——10万</option>
                                <option>10万——11万</option>
                                <option>11万——12万</option>
                                <option>全部</option>
                            </select>
                        </div>

                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="contourvalue_hq" class="col-sm-4 control-label">选择等值线范围(hq)</label>
                            <select id="contourvalue_hq" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>2万以下</option>
                                <option>2万——3万</option>
                                <option>3万——4万</option>
                                <option>4万——5万</option>
                                <option>5万——6万</option>
                                <option>6万——7万</option>
                                <option>7万——8万</option>
                                <option>8万——9万</option>
                                <option>9万——10万</option>
                                <option>10万——11万</option>
                                <option>11万——12万</option>
                                <option>全部</option>
                            </select>
                        </div>

                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="polygon" class="col-sm-4 control-label">是否显示等值面</label>
                            <select id="polygon" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>否</option>
                                <option>是</option>
                            </select>
                        </div>

                    </form>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="polyvalue" class="col-sm-4 control-label">选择等值面范围(hq)</label>
                            <select id="polyvalue" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>2万以下</option>
                                <option>2万——3万</option>
                                <option>3万——4万</option>
                                <option>4万——5万</option>
                                <option>5万——6万</option>
                                <option>6万——7万</option>
                                <option>7万——8万</option>
                                <option>8万——9万</option>
                                <option>9万——10万</option>
                                <option>10万——11万</option>
                                <option>11万——12万</option>
                                <option>全部</option>
                            </select>
                        </div>

                    </form>

                </div>

                <div class="sidebar-pane" id="messages">
                    <h1 class="sidebar-header">学区
                        <span class="sidebar-close"><i class="fa fa-caret-right"></i></span>
                    </h1>

                    <form>
                        小学类型:
                        <select id="schoolType"  style='width:110px;'>
                            <option>无</option>
                            <option>市重点小学</option>
                            <option>区重点小学</option>
                            <option>普通小学</option>
                        </select>
                    </form>

                </div>

                <div class="sidebar-pane" id="grid50">
                    <h1 class="sidebar-header">50m网格插值
                        <span class="sidebar-close"><i class="fa fa-caret-right"></i></span>
                    </h1>

                    <!--下拉列表-->
                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="source_50" class="col-sm-4 control-label">数据来源</label>
                            <select id="source_50" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>我爱我家</option>
                                <option>房天下</option>
                                <option>安居客</option>
                                <option>链家</option>
                                <option>全部</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="type_50" class="col-sm-4 control-label">房源类型</label>
                            <select id="type_50" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>新房</option>
                                <option>二手房</option>
                                <option>租房</option>
                                <option>求租</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gridValue_50" class="col-sm-4 control-label">网格颜色意义</label>
                            <select id="gridValue_50" style='width:200px;'>
                                <option>请选择</option>
                                <option>房价加速度</option>
                                <option>房价</option>
                            </select>
                        </div>
                    </form>

                    <!--标签栏-->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#price_50" role="tab" data-toggle="tab">房价</a></li>
                        <li role="presentation"><a href="#acceleration_50" role="tab" data-toggle="tab">房价加速度</a></li>
                    </ul>
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="price_50">
                            <form class="form-horizontal" role="form">
                                <div class="form-group">
                                    <label for="gridTime_50" class="col-sm-4 control-label">网格房价时间</label>
                                    <select id="gridTime_50" style='width:200px;'>
                                        <option>请选择</option>
                                        <option >2015年07月</option>
                                        <option >2015年08月</option>
                                        <option >2015年09月</option>
                                        <option >2015年10月</option>
                                        <option >2015年11月</option>
                                        <option >2015年12月</option>
                                        <option >2016年01月</option>
                                        <option >2016年02月</option>
                                        <option >2016年03月</option>
                                        <option >2016年04月</option>
                                        <option >2016年05月</option>
                                        <option >2016年06月</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="acceleration_50">
                            <form class="form-horizontal" role="form">
                                <div class="form-group">
                                    <label for="startTime_50" class="col-sm-4 control-label">加速度起始时间</label>
                                    <select id="startTime_50" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>2015年07月</option>
                                        <option>2015年08月</option>
                                        <option>2015年09月</option>
                                        <option>2015年10月</option>
                                        <option>2015年11月</option>
                                        <option>2015年12月</option>
                                        <option>2016年01月</option>
                                        <option>2016年02月</option>
                                        <option>2016年03月</option>
                                        <option>2016年04月</option>
                                        <option>2016年05月</option>
                                        <option>2016年06月</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="endTime_50" class="col-sm-4 control-label">加速度终止时间</label>
                                    <select id="endTime_50" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>2015年07月</option>
                                        <option>2015年08月</option>
                                        <option>2015年09月</option>
                                        <option>2015年10月</option>
                                        <option>2015年11月</option>
                                        <option>2015年12月</option>
                                        <option>2016年01月</option>
                                        <option>2016年02月</option>
                                        <option>2016年03月</option>
                                        <option>2016年04月</option>
                                        <option>2016年05月</option>
                                        <option>2016年06月</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="computation_50" class="col-sm-4 control-label">加速度计算方式</label>
                                    <select id="computation_50" style='width:200px;'>
                                        <option>请选择</option>
                                        <option>最值计算法</option>
                                        <option>起止时间计算法</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                    </div>

                    <form class="form-horizontal" role="form">
                        <div class="form-group">
                            <label for="finish_50" class="col-sm-4 control-label">是否完成选择</label>
                            <select id="finish_50" class ="form-control" style='width:200px;'>
                                <option>请选择</option>
                                <option>是</option>
                                <option>否</option>
                            </select>
                        </div>
                    </form>

                    <!--测试时间延时框-->
                    <form class="form-horizontal" role="form">
                        <input type="button" value="动态房价展示" onClick = "timedMsg()">
                    <!--<p>点击上面的按钮。5 秒后会显示一个消息框。</p>-->
                    </form>

                    <form class="form-horizontal" role="form">
                        <input type="button" value="动态房价循环展示" onClick = "loopTimedMsg()">
                        <button onclick="window.clearInterval(loopTimedMsg())">停止循环展示</button>
                    </form>



                </div>

                <div class="sidebar-pane" id="settings">
                    <h1 class="sidebar-header">Settings<span class="sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
                </div>
            </div>
        </div>

        <div id="map" class="sidebar-map"></div>
    </div>
    </div>

<!--价格曲线模态框-->
<div id="myModal" style="margin: 3%;height: 90%; width: 90%"  class="modal fade bs-example-modal-sm" role="dialog" aria-labelledby="mySmallModalLabel">
    <div class="modal-dialog modal-sm" style="width: 85%;height: 85%;width: 85%;height: 90%;">
        <!--上一行是调节表格后面的白色模板的-->
        <div class="modal-content" style="width: 90%;height: 90%;width: 90%;height: 90%">

            <canvas id="myChart" style="width: 90%;height: 90%;width: 90%;height: 90%"></canvas>

            <div class="modal-footer" style="padding: 0px;border-top: 0px">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>



    </div>
</div>
<!--特征统计模态框-->
<div id="infoModal"  style="margin: 3%;height: 90%; width: 90%;" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog  modal-lg"　style="margin: 3%;height: 90%; width: 90%">
        <div class="modal-content" style="margin: 3%;height: 90%; width: 90%">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    特征统计
                </h4>

                <!--表并列排列-->
            <!--这是暂时不用的了<table width="100%" align="center" style="border-color:rgba(0,0,0,0)">
                <tr style="border-color:rgba(0,0,0,0);background-color:rgba(0,0,0,0)">
                     <td width="25%" style="float: left;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="house_type">
                                <caption>户型</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                                <tr id="house_type_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                    <td align="center">500</td>
                                    <td align="center">500</td>
                                </tr>
                            </table>
                        </td>
                     <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                     <table class="table-bordered hovertable" id="flooron">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                         <caption>所在楼层</caption>
                         <tr>
                             <th align="center">类型</th>
                             <th align="center">数目</th>
                         </tr>
                         <tr id="flooron_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                             <td align="center">500</td>
                             <td align="center">500</td>
                         </tr>
                     </table>
                 </td>
                     <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                         <table class="table-bordered hovertable" id="floors">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                             <caption>总楼层</caption>
                             <tr>
                                 <th align="center">类型</th>
                                 <th align="center">数目</th>
                             </tr>
                             <tr id="floors_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                 <td align="center">500</td>
                                 <td align="center">500</td>
                             </tr>
                         </table>
                     </td>
                     <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                        <table class="table-bordered hovertable" id="direction">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                            <caption>朝向</caption>
                            <tr>
                                <th align="center">类型</th>
                                <th align="center">数目</th>
                            </tr>
                            <tr id="direction_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                <td align="center">500</td>
                                <td align="center">500</td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr style="border-color:rgba(0,0,0,0);background-color:rgba(0,0,0,0)">
                    <td width="40%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                        <table class="table-bordered hovertable" id="unitprice">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                            <caption>单价(万元/㎡)</caption>
                            <tr>
                                <th align="center">类型</th>
                                <th align="center">数目</th>
                            </tr>
                            <tr id="unitprice_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                <td align="center">500</td>
                                <td align="center">500</td>
                            </tr>
                        </table>
                    </td>
                    <td width="30%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                        <table class="table-bordered hovertable" id="area">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                            <caption>面积(㎡)</caption>
                            <tr>
                                <th align="center">类型</th>
                                <th align="center">数目</th>
                            </tr>
                            <tr id="area_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                <td align="center">500</td>
                                <td align="center">500</td>
                            </tr>
                        </table>
                    </td>
                    <td width="30%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                        <table class="table-bordered hovertable" id="totalprice">&lt;!&ndash;table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮&ndash;&gt;
                            <caption>总价(万元)</caption>
                            <tr>
                                <th align="center">类型</th>
                                <th align="center">数目</th>
                            </tr>
                            <tr id="totalprice_1" onmouseover="this.style.backgroundColor='#ffff66';" onmouseout="this.style.backgroundColor='#C6E2FF';">
                                <td align="center">500</td>
                                <td align="center">500</td>
                            </tr>
                        </table>
                    </td>
                     </tr>
            </table>-->
                <table width="100%" align="center" style="border-color:rgba(0,0,0,0)">
                    <tr style="border-color:rgba(0,0,0,0);background-color:rgba(0,0,0,0)">
                        <td width="25%" style="float: left;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="house_type">
                                <caption>户型</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                        <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="flooron"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>所在楼层</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                        <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="floors"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>总楼层</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                        <td width="25%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="direction"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>朝向</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr style="border-color:rgba(0,0,0,0);background-color:rgba(0,0,0,0)">
                        <td width="40%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="unitprice"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>单价(万元/㎡)</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                        <td width="30%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="area"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>面积(㎡)</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                        <td width="30%" style="float: right;margin: 0px;padding: 0px;border-color:rgba(0,0,0,0)">
                            <table class="table-bordered hovertable" id="totalprice"><!--table-hover:这是bootstrap中的方法，也可以实现鼠标所在位置高亮-->
                                <caption>总价(万元)</caption>
                                <tr>
                                    <th align="center">类型</th>
                                    <th align="center">数目</th>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>



            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<script type="text/javascript">
    //把map定义成全局变量
    var map;
    var resize = function () {
        var $map = $('#map');
        $map.height($(window).height() - $('div.navbar').outerHeight());
        if (map) {
            map.invalidateSize();
        }
    };
    $(window).on('resize', function () {
        resize();
    });
    resize();
    var normalm = L.tileLayer.chinaProvider('GaoDe.Normal.Map', {maxZoom: 18, minZoom: 10});
    var imgm = L.tileLayer.chinaProvider('GaoDe.Satellite.Map', {maxZoom: 18, minZoom: 10});
    var imga = L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion', {maxZoom: 18, minZoom: 10});
    var normal = L.layerGroup([normalm]),
            image = L.layerGroup([imgm, imga]);
    var baseLayers = {
        "地图": normal,
        "影像": image,
    }
    var overlayLayers = {};
    map = L.map("map", {
        layers: [normal],
        zoomControl: true
    }).setView([39.906985851984146, 116.39055488416854], 3);
    map.setView([39.906985851984146, 116.39055488416854], 3);




    function timedMsg()
    {
        //alert("执行定时程序");
        var t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2015年10月\")",1);
        console.log("10月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2015年11月\")",1000);
        console.log("11月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2015年12月\")",1000);
        console.log("12月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2016年01月\")",1000);
        console.log("1月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2016年02月\")",1000);
        console.log("2月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2016年03月\")",1000);
        console.log("3月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2016年04月\")",1000);
        console.log("4月");
        t=setTimeout("setPriceGrid(\"房价\",\"\",\"\",\"我爱我家\",\"\",\"2016年05月\")",1000);
        console.log("5月");

    }
    function setPriceGrid(gridValue,startTime,endTime,source,computation,gridTime){
        console.log(map);
        var bounds = map.getBounds();
        var west = bounds.getWest();
        var east = bounds.getEast();
        var south = bounds.getSouth();
        var north = bounds.getNorth();
        var zoom = map.getZoom();

        if (gridValue == "房价加速度") {
            var json = {
                "west": west,
                "east": east,
                "south": south,
                "north": north,
                "zoom": zoom,
                "starttime": startTime,
                "endtime": endTime,
                "source": source,
                "computation":computation
            };
            $.post("/gridacceleration_50", "" + JSON.stringify(json), function (result) {
                var price = JSON.parse(result);
                draw_rectangle_Acceleration_50(bounds, price);
            });
        }
        else if(gridValue == "房价"){
            var json = {
                "west": west,
                "east": east,
                "south": south,
                "north": north,
                "zoom": zoom,
                "gridTime": gridTime,
                "source": source
            };
            $.post("/gridcolor_50", "" + JSON.stringify(json), function (result) {
                var price = JSON.parse(result);
                //console.log("每移动一次开始画网格");
                draw_rectangle_houseprice_50(price);//1表示显示插值数据的曲线，2表示显示原始数据的曲线
            });
        }

    }
    function loopTimedMsg(){

        var int=self.setInterval("timedMsg()",5000)
    }




   // $(document).ready(function () {


        var sidebar = L.control.sidebar('sidebar', {position: 'right'}).addTo(map);

        $("#schoolType").change(function () {
        var x = document.getElementById("schoolType").selectedIndex;
        var y = document.getElementById("schoolType").options;
        var schoolType = y[x].text;

        if (schoolType == "市重点小学") {
            for (var i = 0; i < cityfocus.length; i++) {
                map.removeLayer(cityfocus[i]);
            }
            for (var i = 0; i < regionfocus.length; i++) {
                map.removeLayer(regionfocus[i]);
            }
            for (var i = 0; i < ordinary.length; i++) {
                map.removeLayer(ordinary[i]);
            }
            //市重点
            $.post("/static/city_focused", "" + map.getZoom(), function (result) {
                var school = JSON.parse(result);
                draw_circle_cityfocus(school);
            });

        } else if (schoolType == "区重点小学") {
            for (var i = 0; i < cityfocus.length; i++) {
                map.removeLayer(cityfocus[i]);
            }
            for (var i = 0; i < regionfocus.length; i++) {
                map.removeLayer(regionfocus[i]);
            }
            for (var i = 0; i < ordinary.length; i++) {
                map.removeLayer(ordinary[i]);
            }
            //区重点
            $.post("/static/region_focused", "" + map.getZoom(), function (result) {
                var school = JSON.parse(result);
                draw_circle_regionfocus(school);
            });
        } else if (schoolType == "普通小学") {
            for (var i = 0; i < cityfocus.length; i++) {
                map.removeLayer(cityfocus[i]);
            }
            for (var i = 0; i < regionfocus.length; i++) {
                map.removeLayer(regionfocus[i]);
            }
            for (var i = 0; i < ordinary.length; i++) {
                map.removeLayer(ordinary[i]);
            }
            //普通小学
            $.post("/static/ordinary_primary_school", "" + map.getZoom(), function (result) {
                var school = JSON.parse(result);
                draw_circle_ordinary(school);
            });
        }
    });

        $("#chazhi").change(function () {
            var x = document.getElementById("chazhi").selectedIndex;
            var y = document.getElementById("chazhi").options;
            var chazhi = y[x].text;
            if(chazhi=="是"){
                alert("画插值后的网格图");
                console.log("删除之前的网格~");
                var json = {
                    "gridTime": "2015年10月"
                };
                $.post("/gridcolor_interpolation", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    console.log("开始画网格");
                    draw_rectangle_interpolation(price);
                });
            }else {
                alert("请到原始数据栏目中选择条件");
                creatGrid();
            }
        }
        );

        $("#contourline").change(function () {
        var x = document.getElementById("contourline").selectedIndex;
        var y = document.getElementById("contourline").options;
        var contourline = y[x].text;
        if(contourline=="是"){

            /*$.post("/static/contourline/polygon_2", function (result) {
                var contour = JSON.parse(result);
                console.log("开始画等值线");
                draw_multiPolyline(contour,2);
            });*/
            $("#contourvalue").change(function () {

                var x = document.getElementById("contourvalue").selectedIndex;
                var y = document.getElementById("contourvalue").options;
                var contourvalue=y[x].text;

                /*如果选择全部画，那就需要删除之前的等值线了，故在删除等值线之前要做一个判断，1：表示删除之前的等值线，0表示不删除*/
                if(contourvalue=="2万——3万"){
                    $.post("/static/contourline/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,2,1);
                    });
                }else if(contourvalue=="3万——4万"){
                    $.post("/static/contourline/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,3,1);
                    });
                }else if(contourvalue=="4万——5万"){
                    $.post("/static/contourline/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,4,1);
                    });
                }else if(contourvalue=="5万——6万"){
                    $.post("/static/contourline/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,5,1);
                    });
                }else if(contourvalue=="6万——7万"){
                    $.post("/static/contourline/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,6,1);
                    });
                }else if(contourvalue=="7万——8万"){
                    $.post("/static/contourline/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,7,1);
                    });
                }else if(contourvalue=="8万——9万"){
                    $.post("/static/contourline/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,8,1);
                    });
                }else if(contourvalue=="9万——10万"){
                    $.post("/static/contourline/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,9,1);
                    });
                }else if(contourvalue=="10万——11万"){
                    $.post("/static/contourline/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,10,1);
                    });
                }else if(contourvalue=="11万——12万"){
                    $.post("/static/contourline/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,11,1);
                    });
                }else if(contourvalue=="全部"){
                    $.post("/static/contourline/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,2,0);
                    });
                    $.post("/static/contourline/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,3,0);
                    });
                    $.post("/static/contourline/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,4,0);
                    });
                    $.post("/static/contourline/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,5,0);
                    });
                    $.post("/static/contourline/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,6,0);
                    });
                    $.post("/static/contourline/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,7,0);
                    });
                    $.post("/static/contourline/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,8,0);
                    });
                    $.post("/static/contourline/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,9,0);
                    });
                    $.post("/static/contourline/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,10,0);
                    });
                    $.post("/static/contourline/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,11,0);
                    });
                }
            });

            //这是汉青的数据
            $("#contourvalue_hq").change(function () {

                var x = document.getElementById("contourvalue_hq").selectedIndex;
                var y = document.getElementById("contourvalue_hq").options;
                var contourvalue_hq=y[x].text;

                /*如果选择全部画，那就需要删除之前的等值线了，故在删除等值线之前要做一个判断，1：表示删除之前的等值线，0表示不删除*/
                if(contourvalue_hq=="2万——3万"){
                    $.post("/static/contourline/hq/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,2,1);
                    });
                }else if(contourvalue_hq=="3万——4万"){
                    $.post("/static/contourline/hq/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,3,1);
                    });
                }else if(contourvalue_hq=="4万——5万"){
                    $.post("/static/contourline/hq/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,4,1);
                    });
                }else if(contourvalue_hq=="5万——6万"){
                    $.post("/static/contourline/hq/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,5,1);
                    });
                }else if(contourvalue_hq=="6万——7万"){
                    $.post("/static/contourline/hq/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,6,1);
                    });
                }else if(contourvalue_hq=="7万——8万"){
                    $.post("/static/contourline/hq/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,7,1);
                    });
                }else if(contourvalue_hq=="8万——9万"){
                    $.post("/static/contourline/hq/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,8,1);
                    });
                }else if(contourvalue_hq=="9万——10万"){
                    $.post("/static/contourline/hq/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,9,1);
                    });
                }else if(contourvalue_hq=="10万——11万"){
                    $.post("/static/contourline/hq/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,10,1);
                    });
                }else if(contourvalue_hq=="11万——12万"){
                    $.post("/static/contourline/hq/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,11,1);
                    });
                }else if(contourvalue_hq=="全部"){
                    $.post("/static/contourline/hq/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,2,0);
                    });
                    $.post("/static/contourline/hq/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,3,0);
                    });
                    $.post("/static/contourline/hq/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,4,0);
                    });
                    $.post("/static/contourline/hq/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,5,0);
                    });
                    $.post("/static/contourline/hq/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,6,0);
                    });
                    $.post("/static/contourline/hq/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,7,0);
                    });
                    $.post("/static/contourline/hq/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,8,0);
                    });
                    $.post("/static/contourline/hq/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,9,0);
                    });
                    $.post("/static/contourline/hq/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,10,0);
                    });
                    $.post("/static/contourline/hq/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值线");
                        draw_multiPolyline(contour,11,0);
                    });
                }
            });

        }else {
            //将之前的多线图层删除
            if (polyline_array.length != 0) {
                for (var i = 0; i < polyline_array.length; i++) {
                    map = map.removeLayer(polyline_array[i]);
                }
                polyline_array = [];
            }
        }
    });

        $("#polygon").change(function(){
        var x = document.getElementById("polygon").selectedIndex;
        var y = document.getElementById("polygon").options;
        var polygon = y[x].text;
        if(polygon=="是"){
            $("#polyvalue").change(function(){
                var x = document.getElementById("polyvalue").selectedIndex;
                var y = document.getElementById("polyvalue").options;
                var polyvalue = y[x].text;
                if(polyvalue=="2万——3万"){
                    $.post("/static/polygon/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,2,1);
                    });
                }else if(polyvalue=="3万——4万"){
                    $.post("/static/polygon/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,3,1);
                    });
                }else if(polyvalue=="4万——5万"){
                    $.post("/static/polygon/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,4,1);
                    });
                }else if(polyvalue=="5万——6万"){
                    $.post("/static/polygon/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,5,1);
                    });
                }else if(polyvalue=="6万——7万"){
                    $.post("/static/polygon/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,6,1);
                    });
                }else if(polyvalue=="7万——8万"){
                    $.post("/static/polygon/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,7,1);
                    });
                }else if(polyvalue=="8万——9万"){
                    $.post("/static/polygon/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,8,1);
                    });
                }else if(polyvalue=="9万——10万"){
                    $.post("/static/polygon/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,9,1);
                    });
                }else if(polyvalue=="10万——11万"){
                    $.post("/static/polygon/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,10,1);
                    });
                }else if(polyvalue=="11万——12万"){
                    $.post("/static/polygon/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,11,1);
                    });
                }else if(polyvalue=="全部"){
                    $.post("/static/polygon/polygon_2", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,2,0);
                    });
                    $.post("/static/polygon/polygon_3", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,3,0);
                    });
                    $.post("/static/polygon/polygon_4", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,4,0);
                    });
                    $.post("/static/polygon/polygon_5", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,5,0);
                    });
                    $.post("/static/polygon/polygon_6", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,6,0);
                    });
                    $.post("/static/polygon/polygon_7", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,7,0);
                    });
                    $.post("/static/polygon/polygon_8", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,8,0);
                    });
                    $.post("/static/polygon/polygon_9", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,9,0);
                    });
                    $.post("/static/polygon/polygon_10", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,10,0);
                    });
                    $.post("/static/polygon/polygon_11", function (result) {
                        var contour = JSON.parse(result);
                        console.log("开始画等值面");
                        draw_Polygon(contour,11,0);
                    });
                }
            });
        }else if(polygon=="否"){
            //将polygon全部删除
            if (polygon_array.length != 0) {
                for (var i = 0; i < polygon_array.length; i++) {
                    map = map.removeLayer(polygon_array[i]);
                }
                polygon_array = [];
            }
        }
    });

        //弹出曲线框的时候触发的事件
        $("#select_source").change(function(){
        var x = document.getElementById("select_source").selectedIndex;
        var y = document.getElementById("select_source").options;
        var select_source = y[x].text;
        if(select_source=="我爱我家"){

        }else if(select_source=="房天下"){

        }else if(select_source=="安居客"){

        }else if(select_source=="链家"){

        }else if(select_source=="全部"){

        }

        $('#changeDataObject').click(function() {
            config.data = {
                labels: ["July", "August", "September", "October", "November", "December"],
                datasets: [{
                    label: "My First dataset",
                    data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()],
                    fill: false,
                }, {
                    label: "My Second dataset",
                    fill: false,
                    data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()],
                }]
            };

            $.each(config.data.datasets, function(i, dataset) {
                dataset.borderColor = randomColor(0.4);
                dataset.backgroundColor = randomColor(0.5);
                dataset.pointBorderColor = randomColor(0.7);
                dataset.pointBackgroundColor = randomColor(0.5);
                dataset.pointBorderWidth = 1;
            });

            // Update the chart
            window.myLine.update();
        });

        $('#addDataset').click(function() {
            var newDataset = {
                label: 'Dataset ' + config.data.datasets.length,
                borderColor: randomColor(0.4),
                backgroundColor: randomColor(0.5),
                pointBorderColor: randomColor(0.7),
                pointBackgroundColor: randomColor(0.5),
                pointBorderWidth: 1,
                data: [],
            };

            for (var index = 0; index < config.data.labels.length; ++index) {
                newDataset.data.push(randomScalingFactor());
            }

            config.data.datasets.push(newDataset);
            window.myLine.update();
        });

        $('#addData').click(function() {
            if (config.data.datasets.length > 0) {
                var month = MONTHS[config.data.labels.length % MONTHS.length];
                config.data.labels.push(month);

                $.each(config.data.datasets, function(i, dataset) {
                    dataset.data.push(randomScalingFactor());
                });

                window.myLine.update();
            }
        });

        $('#removeDataset').click(function() {
            config.data.datasets.splice(0, 1);
            window.myLine.update();
        });

        $('#removeData').click(function() {
            config.data.labels.splice(-1, 1); // remove the label first

            config.data.datasets.forEach(function(dataset, datasetIndex) {
                dataset.data.pop();
            });

            window.myLine.update();
        });
    });

        var x_source;
        var y_source;
        var source;
        $("#source").change(function () {
          x_source = document.getElementById("source").selectedIndex;
          y_source = document.getElementById("source").options;
          source = y_source[x_source].text;
    });
        var x_type;
        var y_type;
        var type;
        $("#type").change(function () {
        x_type = document.getElementById("type").selectedIndex;
        y_type = document.getElementById("type").options;
        type = y_type[x_type].text;
    });
        var gridValue;
        var x_gridValue;
        var y_gridValue;
        $("#gridValue").change(function () {
        x_gridValue = document.getElementById("gridValue").selectedIndex;
        y_gridValue = document.getElementById("gridValue").options;
        gridValue = y_gridValue[x_gridValue].text;
    });
        var polygon_array = [];
        var polyline_array = [];
        var cityfocus = [];
        var regionfocus = [];
        var ordinary = [];
        //原始数据的触发
        $("#finish").change(function(){
            var x = document.getElementById("finish").selectedIndex;
            var y = document.getElementById("finish").options;
            var finish = y[x].text;
            if(finish=="是"){
                creatGrid();
                creatGrid_investment_50();
            }else if(finish=="否"){
                alert("请再次选择需要显示的数据");
            }
        });
        //插值数据的触发
        $("#finish_50").change(function(){
            var x = document.getElementById("finish_50").selectedIndex;
            var y = document.getElementById("finish_50").options;
            var finish = y[x].text;
            if(finish=="是"){
                creatGrid_50();
            }else if(finish=="否"){
                alert("请再次选择需要显示的数据");
            }
        });

        //清除当前所有的网格
        $("#delect").change(function(){
            delect_all_rectangle();
        });


        //creatGrid_investment_50：以50*50格网为基元，计算投资效益
        function creatGrid_investment_50() {
            var bounds = map.getBounds();
            var west = bounds.getWest();
            var east = bounds.getEast();
            var south = bounds.getSouth();
            var north = bounds.getNorth();
            var zoom = map.getZoom();

            var x1 = document.getElementById("computation_invest").selectedIndex;
            var y1 = document.getElementById("computation_invest").options;
            var investment = y1[x1].text;

            var x2 = document.getElementById("gridTime_invest").selectedIndex;
            var y2 = document.getElementById("gridTime_invest").options;
            var time = y2[x2].text;

            var x3 = document.getElementById("source").selectedIndex;
            var y3 = document.getElementById("source").options;
            var source = y3[x3].text;



            var json = {
                "west": west,
                "east": east,
                "south": south,
                "north": north,
                "zoom": zoom,
                "gridTime": time,
                "source": source,
                "investment":investment
            };

            $.post("/investment", "" + JSON.stringify(json), function (result) {
                var price = JSON.parse(result);
                draw_rectangle_investment_50(price);
            });
        }

        //creatGrid：通过获取当前屏幕的经纬度坐标实现该范围内的网格可视化
        function creatGrid() {
            var bounds = map.getBounds();
            console.log(bounds);
            var west = bounds.getWest();
            var east = bounds.getEast();
            var south = bounds.getSouth();
            var north = bounds.getNorth();
            var zoom = map.getZoom();
            console.log(zoom);

            var x = document.getElementById("gridValue").selectedIndex;
            var y = document.getElementById("gridValue").options;
            var gridValue = y[x].text;
            if (gridValue == "房价加速度") {
                x = document.getElementById("startTime").selectedIndex;
                y = document.getElementById("startTime").options;
                var startTime = y[x].text;

                x = document.getElementById("endTime").selectedIndex;
                y = document.getElementById("endTime").options;
                var endTime = y[x].text;

                x = document.getElementById("source").selectedIndex;
                y = document.getElementById("source").options;
                var source = y[x].text;

                x = document.getElementById("computation").selectedIndex;
                y = document.getElementById("computation").options;
                var computation = y[x].text;

                var json = {
                    "west": west,
                    "east": east,
                    "south": south,
                    "north": north,
                    "zoom": zoom,
                    "starttime": startTime,
                    "endtime": endTime,
                    "source": source,
                    "computation":computation
                };
                $.post("/gridacceleration", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    draw_rectangle_Acceleration(bounds, price);
                });

            } else if (gridValue == "房价") {
                x = document.getElementById("gridTime").selectedIndex;
                y = document.getElementById("gridTime").options;
                var gridTime = y[x].text;

                x = document.getElementById("source").selectedIndex;
                y = document.getElementById("source").options;
                var source = y[x].text;

                var json = {
                    "west": west,
                    "east": east,
                    "south": south,
                    "north": north,
                    "zoom": zoom,
                    "gridTime": gridTime,
                    "source": source
                };
                $.post("/gridcolor", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    //console.log("每移动一次开始画网格");
                    draw_rectangle_houseprice(price);
                });
            }else if(gridValue == "投资价格"){
                x = document.getElementById("computation_invest").selectedIndex;
                y = document.getElementById("computation_invest").options;
                var investment = y[x].text;

                x = document.getElementById("gridTime_invest").selectedIndex;
                y = document.getElementById("gridTime_invest").options;
                var time = y[x].text;

                x = document.getElementById("source").selectedIndex;
                y = document.getElementById("source").options;
                var source = y[x].text;

                var json = {
                    "west": west,
                    "east": east,
                    "south": south,
                    "north": north,
                    "zoom": zoom,
                    "gridTime": time,
                    "source": source,
                    "investment":investment
                };

                $.post("/investment", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    draw_rectangle_investment_50(price);
                });
            }
        }

        //creatGrid_50：通过获取当前屏幕的经纬度坐标实现该范围内的网格可视化(基础数据是50*50网格)
        function creatGrid_50() {
            var bounds = map.getBounds();
            console.log(bounds);
            var west = bounds.getWest();
            var east = bounds.getEast();
            var south = bounds.getSouth();
            var north = bounds.getNorth();
            var zoom = map.getZoom();
            console.log(zoom);

            var x = document.getElementById("gridValue_50").selectedIndex;
            var y = document.getElementById("gridValue_50").options;
            var gridValue = y[x].text;
            if (gridValue == "房价加速度") {
                x = document.getElementById("startTime_50").selectedIndex;
                y = document.getElementById("startTime_50").options;
                var startTime = y[x].text;

                x = document.getElementById("endTime_50").selectedIndex;
                y = document.getElementById("endTime_50").options;
                var endTime = y[x].text;

                x = document.getElementById("source_50").selectedIndex;
                y = document.getElementById("source_50").options;
                var source = y[x].text;

                x = document.getElementById("computation_50").selectedIndex;
                y = document.getElementById("computation_50").options;
                var computation = y[x].text;

                var json = {
                    "west": west,
                    "east": east,
                    "south": south,
                    "north": north,
                    "zoom": zoom,
                    "starttime": startTime,
                    "endtime": endTime,
                    "source": source,
                    "computation":computation
                };
                $.post("/gridacceleration_50", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    draw_rectangle_Acceleration_50(bounds, price);
                });

            } else if (gridValue == "房价") {
                x = document.getElementById("gridTime_50").selectedIndex;
                y = document.getElementById("gridTime_50").options;
                var gridTime = y[x].text;

                x = document.getElementById("source_50").selectedIndex;
                y = document.getElementById("source_50").options;
                var source = y[x].text;

                var json = {
                    "west": west,
                    "east": east,
                    "south": south,
                    "north": north,
                    "zoom": zoom,
                    "gridTime": gridTime,
                    "source": source
                };
                $.post("/gridcolor_50", "" + JSON.stringify(json), function (result) {
                    var price = JSON.parse(result);
                    console.log("每移动一次开始画网格");
                    draw_rectangle_houseprice_50(price);//1表示显示插值数据的曲线，2表示显示原始数据的曲线
                });
            }
        }

        //dragend：拖动地图时能实现不同网格的生成，主要用于同一zoom下的不同范围内的网格生成
        map.on('dragend', function (e) {
            creatGrid();
            creatGrid_50();
        });
        //zoomend：缩放地图时能实现不同分辨率下网格的生成，主要用于不同zoom下当前屏幕范围内的网格生成
        map.on('zoomend', function (e) {
            creatGrid();
            creatGrid_50();
        });
        function draw_circle_cityfocus(school) {
        var myIcon = L.icon({
            iconUrl: 'http://c.hiphotos.baidu.com/image/w%3D310/sign=913f487c4336acaf59e090fd4cd88d03/5fdf8db1cb13495453f3e3215e4e9258d0094a81.jpg',
            iconRetinaUrl: 'http://h.hiphotos.baidu.com/image/w%3D310/sign=705c47440255b3199cf9847473a88286/03087bf40ad162d92d4c695919dfa9ec8b13cdd1.jpg',
            iconSize: [50, 94],
            iconAnchor: [22, 94],
            popupAnchor: [-3, -76],
            shadowUrl: 'http://a.hiphotos.baidu.com/image/w%3D310/sign=99ae3420bb19ebc4c0787098b227cf79/7af40ad162d9f2d3b7b32faaa1ec8a136227ccd1.jpg',
            shadowRetinaUrl: 'http://d.hiphotos.baidu.com/image/w%3D310/sign=2dd97543a4af2eddd4f14fe8bd110102/8cb1cb13495409238684683b9a58d109b2de4981.jpg',
            shadowSize: [68, 95],
            shadowAnchor: [22, 94]
        });
        var size = school.data.length;
        var lng;
        var lat;
        var info;
        var title;
        var address;
        var location;
        var type;
        var content;
        var latlng;
        var popup;

        gradeOptions.radius = 10;
        gradeOptions.color = gradeOptions.fillColor = 'hsl(' + 359 + ',100%,70%)';

        for (var i = 0; i < size; i++) {
            info = school.data[i];
            lng = info.longitude;
            lat = info.latitude;
            /*var marker =L.marker([lat,lng,100],{icon: myIcon});*/
            var marker = L.mapMarker([lat, lng, 100], gradeOptions);
            map.addLayer(marker);

            title = info.school;
            location = info.region;
            address = info.address;
            type = info.type;
            content = "<DIV><span style=\"font-weight:bold;\"></span></DIV><HR/><DIV><span>" + title + "</span></DIV><BR/><DIV><span  style=\"font-weight:bold;\">区域:	</span> <span>" + location + "</span></DIV><DIV><span  style=\"font-weight:bold;\">地址:	</span> <span>" + address + "</span></DIV><DIV><span  style=\"font-weight:bold;\">类型:	</span><span>" + type + "<span></DIV>";
            latlng = L.latLng(lat, lng, 100);
            popup = L.popup()
                    .setLatLng(latlng)
                    .setContent(content);
            // .openOn(map);
            marker.bindPopup(popup);

            cityfocus.push(marker);
        }

    }
        function draw_circle_regionfocus(school) {
        var myIcon = L.icon({
            iconUrl: 'http://c.hiphotos.baidu.com/image/w%3D310/sign=913f487c4336acaf59e090fd4cd88d03/5fdf8db1cb13495453f3e3215e4e9258d0094a81.jpg',
            iconRetinaUrl: 'http://h.hiphotos.baidu.com/image/w%3D310/sign=705c47440255b3199cf9847473a88286/03087bf40ad162d92d4c695919dfa9ec8b13cdd1.jpg',
            iconSize: [50, 94],
            iconAnchor: [22, 94],
            popupAnchor: [-3, -76],
            shadowUrl: 'http://a.hiphotos.baidu.com/image/w%3D310/sign=99ae3420bb19ebc4c0787098b227cf79/7af40ad162d9f2d3b7b32faaa1ec8a136227ccd1.jpg',
            shadowRetinaUrl: 'http://d.hiphotos.baidu.com/image/w%3D310/sign=2dd97543a4af2eddd4f14fe8bd110102/8cb1cb13495409238684683b9a58d109b2de4981.jpg',
            shadowSize: [68, 95],
            shadowAnchor: [22, 94]
        });
        var size = school.data.length;
        var lng;
        var lat;
        var info;
        var title;
        var address;
        var location;
        var type;
        var content;
        var latlng;
        var popup;
        gradeOptions.radius = 10;
        gradeOptions.color = gradeOptions.fillColor = 'hsl(' + 285 + ',100%,70%)';
        for (var i = 0; i < size; i++) {
            info = school.data[i];
            lng = info.longitude;
            lat = info.latitude;

            /*var marker =L.marker([lat,lng,100],{icon: myIcon});*/
            var marker = L.mapMarker([lat, lng, 100], gradeOptions);
            map.addLayer(marker);

            title = info.school;
            location = info.region;
            address = info.address;
            type = info.type;
            content = "<DIV><span style=\"font-weight:bold;\"></span></DIV><HR/><DIV><span>" + title + "</span></DIV><BR/><DIV><span  style=\"font-weight:bold;\">区域:	</span> <span>" + location + "</span></DIV><DIV><span  style=\"font-weight:bold;\">地址:	</span> <span>" + address + "</span></DIV><DIV><span  style=\"font-weight:bold;\">类型:	</span><span>" + type + "<span></DIV>";
            latlng = L.latLng(lat, lng, 100);
            popup = L.popup()
                    .setLatLng(latlng)
                    .setContent(content);
            //.openOn(map);
            marker.bindPopup(popup);

            regionfocus.push(marker);
        }
    }
        function draw_circle_ordinary(school) {
        var myIcon = L.icon({
            iconUrl: 'http://c.hiphotos.baidu.com/image/w%3D310/sign=913f487c4336acaf59e090fd4cd88d03/5fdf8db1cb13495453f3e3215e4e9258d0094a81.jpg',
            iconRetinaUrl: 'http://h.hiphotos.baidu.com/image/w%3D310/sign=705c47440255b3199cf9847473a88286/03087bf40ad162d92d4c695919dfa9ec8b13cdd1.jpg',
            iconSize: [50, 94],
            iconAnchor: [22, 94],
            popupAnchor: [-3, -76],
            shadowUrl: 'http://a.hiphotos.baidu.com/image/w%3D310/sign=99ae3420bb19ebc4c0787098b227cf79/7af40ad162d9f2d3b7b32faaa1ec8a136227ccd1.jpg',
            shadowRetinaUrl: 'http://d.hiphotos.baidu.com/image/w%3D310/sign=2dd97543a4af2eddd4f14fe8bd110102/8cb1cb13495409238684683b9a58d109b2de4981.jpg',
            shadowSize: [68, 95],
            shadowAnchor: [22, 94]
        });
        var size = school.data.length;
        var lng;
        var lat;
        var info;
        var title;
        var address;
        var location;
        var type;
        var content;
        var latlng;
        var popup;
        gradeOptions.radius = 10;
        gradeOptions.color = gradeOptions.fillColor = 'hsl(' + 240 + ',100%,70%)';

        for (var i = 0; i < size; i++) {
            info = school.data[i];
            lng = info.longitude;
            lat = info.latitude;
            /*var marker =L.marker([lat,lng,100],{icon: myIcon});*/
            var marker = L.mapMarker([lat, lng, 100], gradeOptions);
            map.addLayer(marker);

            title = info.school;
            location = info.region;
            address = info.address;
            type = info.type;
            content = "<DIV><span style=\"font-weight:bold;\"></span></DIV><HR/><DIV><span>" + title + "</span></DIV><BR/><DIV><span  style=\"font-weight:bold;\">区域:	</span> <span>" + location + "</span></DIV><DIV><span  style=\"font-weight:bold;\">地址:	</span> <span>" + address + "</span></DIV><DIV><span  style=\"font-weight:bold;\">类型:	</span><span>" + type + "<span></DIV>";
            latlng = L.latLng(lat, lng, 100);
            popup = L.popup()
                    .setLatLng(latlng)
                    .setContent(content);
            // .openOn(map);
            marker.bindPopup(popup);

            ordinary.push(marker);
        }
    }
        function draw_Polygon(contour,value,retain){

        if(retain==1){
            //将polygon全部删除
            if (polygon_array.length != 0) {
                for (var i = 0; i < polygon_array.length; i++) {
                    map = map.removeLayer(polygon_array[i]);
                }
                polygon_array = [];
            }
        }else if(retain==0){
            //不删除之前的多线图层
        }
        var color;
        color=colorSet(value);
        console.log(color);
        //color=randomColor(1);

        for(var tag=0;tag<contour.length;tag++){
            var coordinates;
            if(contour[tag].type=="Polygon"){

                var independent_polygon=contour[tag].coordinates;
                draw_independent_polygon(independent_polygon,color,tag);

            }else if(contour[tag].type=="MultiPolygon"){
                var independent_polygons=contour[tag].coordinates;
                var length=independent_polygons.length;
                console.log(length);
                for(var len=0;len<length;len++){
                    var coors=independent_polygons[len];
                    draw_independent_polygon(coors,color,tag);
                }
            }
        }
    }
        function colorSet(value){
        var color;
        if(value==2){
            color="#077BEA";
        }else if(value==3){
            color="#03EAE4";
        }else if(value==4){
            color="#06E884";
        }else if(value==5){
            color="#B8E705";
        }else if(value==6){
            color="#E9E507";
        }else if(value==7){
            color="#E9A708";
        }else if(value==8){
            color="#EA4706";
        }else if(value==9){
            color="#C70305";
        }else if(value==10){
            color="#C70305";
        }else if(value==11){
            color="#C70305";
        }
        return color;
    }
        //画一个单独的多边形，该多边形里面可能含有内洞
        function draw_independent_polygon(independent_polygon,color,k){
        var latlngss=[];
        var latlngs=[];
        var latlng;
        //计算一共有多少个封闭的多边形
        var len=independent_polygon.length;
        console.log(len);
        for(var mm=0;mm<len;mm++){
            var coors=independent_polygon[mm];
            //分别画每一个多边形，获取每一个多边形里面的坐标点，存放在latlngs中
            for(var i=0;i<coors.length;i++){
                var coordinate=coors[i];
                var lng=coordinate[0];
                var lat=coordinate[1];
                latlng=L.latLng(lat,lng);
                latlngs.push(latlng);
            }
            latlngss.push(latlngs);
            latlngs= [];
        }

        var poly = new L.Polygon(latlngss, {
            color: color,
            fillColor: color,
            stroke: true,
            opacity:0.8,//不透明度
            fillOpacity:0.8,
            weight: 5
        });
        map.addLayer(poly);
        polygon_array.push(poly);
        var content = "<DIV><span style=\"font-weight:bold;\"></span></DIV><HR/><DIV><span>" + "第" +k+"个polygon"+ "</span></DIV>";
        var popup = L.popup()
                .setLatLng(latlngs[0])
                .setContent(content);
        //.openOn(map);
        poly.bindPopup(popup);
    }
        function draw_multiPolyline(contour,value,retain) {

        if(retain==1){
            //将之前的多线图层删除
            if (polyline_array.length != 0) {
                for (var i = 0; i < polyline_array.length; i++) {
                    map = map.removeLayer(polyline_array[i]);
                }
                polyline_array = [];
            }
        }else if(retain==0){
            //不删除之前的多线图层
        }


        var color;//randomColor(0.4)
        color=colorSet(value);//根据value值设置色彩阶梯
        color=randomColor(1);//设置随机色
        var poly_line = new L.Polyline([], {
            color: color,
            fillColor: color,
            stroke: true,
            weight: 3,
            smoothFactor: 5,
            fillOpacity: 1,
            opacity: 1
        });//折线

        for(var tag=0;tag<contour.length;tag++){
            var poly_points = [];
            var coordinates;
            var latlng;
            if(contour[tag].type=="Polygon"){
                //计算一共有多少个封闭的多边形
                var len=contour[tag].coordinates.length;
                console.log(len);


                for(var mm=0;mm<len;mm++){
                    var coors=contour[tag].coordinates[mm];
                    //分别画每一个多边形，获取每一个多边形里面的坐标点，存放在poly_points中
                    for(var i=0;i<coors.length;i++){
                        var coordinate=coors[i];
                        var lng=coordinate[0];
                        var lat=coordinate[1];
                        latlng=L.latLng(lat,lng);
                        poly_points.push(latlng);
                        poly_line.addLatLng(latlng);
                    }
                    map.addLayer(poly_line);
                    polyline_array.push(poly_line);

                    color=randomColor(1);
                    poly_points = [];
                    poly_line = new L.Polyline([], {
                        color: color,
                        fillColor: color,
                        stroke: true,
                        weight: 3,
                        smoothFactor: 5,
                        fillOpacity: 1,
                        opacity: 1
                    });//折线
                }

            }else if(contour[tag].type=="MultiPolygon"){
                var lenen=contour[tag].coordinates.length;
                console.log(lenen);
                for(var m=0;m<lenen;m++){
                    var len1=contour[tag].coordinates[m].length;
                    console.log(len1);
                    for(var j=0;j<len1;j++){
                        coordinates=contour[tag].coordinates[m][j];
                        var len2=coordinates.length;
                        console.log(len2);
                        for(var i=0;i<len2;i++){
                            var coordinate=coordinates[i];
                            var lng=coordinate[0];
                            var lat=coordinate[1];
                            latlng=L.latLng(lat,lng);
                            poly_points.push(latlng);
                            poly_line.addLatLng(latlng);
                        }
                        map.addLayer(poly_line);
                        polyline_array.push(poly_line);

                        //color=randomColor(1);
                        poly_points = [];
                        poly_line = new L.Polyline([], {
                            color: color,
                            fillColor: color,
                            stroke: true,
                            weight: 3,
                            smoothFactor: 5,
                            fillOpacity: 1,
                            opacity: 1
                        });//折线
                    }
                }
            }
        }
        alert("总共画了"+contour.length+"个多边形");
    }
        //将所有的网格全部删除
        function delect_all_rectangle(){
            //将之前的图层删除
            if (rects.length != 0) {
                for (var i = 0; i < rects.length; i++) {
                    map = map.removeLayer(rects[i]);
                }
                rects = [];
            }
        }

        //原始数据网格绘制
        function draw_rectangle_houseprice(price) {
        var N = price.N;
        var width = 0.0011785999999997187 * N;//每N00m的经度差
        var length = 9.003999999997348E-4 * N;//每N00m的纬度差
        var r_min = price.r_min;
        var r_max = price.r_max;
        var c_min = price.c_min;
        var c_max = price.c_max;

        var row;
        var col;

        //将之前的图层删除
        if (rects.length != 0) {
            for (var i = 0; i < rects.length; i++) {
                map = map.removeLayer(rects[i]);
            }
            rects = [];
        }

        var count = 0;
        for (row = r_min; row <= r_max; row++) {
            for (col = c_min; col <= c_max; col++) {

                //parseInt:取整数部分
                //Math.ceil():只要有小数就加1
                var cols=parseInt(2000 / N);
                var gridcode_js = col +  cols* (row - 1);
                //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                var dist_wid = (col - 1) * width;
                var dist_len = (row - 1) * length;
                var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                var rect;
                var gridvalue = price.data[count];
                var gridcode_java = gridvalue.code;
                var gridcolor = gridvalue.color;
                var gridrow = gridvalue.row;
                var gridcol = gridvalue.col;
                var averageprice = gridvalue.average_price;

                if (gridcode_js == gridcode_java) {
                    if (averageprice != 0) {
                        //console.log(count);
                        rect = L.rectangle(bounds, {
                            color: mycolor(255, 255, 255),
                            opacity: 0.9,
                            fillColor: gridcolor,
                            weight: 1,
                            fillOpacity: 0.6,
                            className: "" + gridcode_java
                        });//,className:gridcode_java
                        rect.index = count;
                        rect.data = price.data[rect.index];

                        rect.on('click', function (e) {
                            var json = {
                                "row": this.data.row,
                                "col": this.data.col,
                                "code": this.data.code,
                                "N": N
                            };

                            $.post("/price", JSON.stringify(json),
                                    function (data) {
                                        var ctx = document.getElementById("myChart").getContext("2d");
                                        pricedata = JSON.parse(data);

                                        var max = pricedata.suggestedMax;
                                        var min = pricedata.suggestedMin;

                                        var grid = JSON.stringify(json);
                                        var gridinfo = JSON.parse(grid);
                                        var info = "编码：" + gridinfo.code + "," + gridinfo.row + "行" + gridinfo.col + "列";
                                        window.myLine = new Chart(ctx, dataStruct(pricedata, info, max, min));
                                        $('#myModal').modal();
                                    }
                            )
                        });

                        rect.addTo(map);
                        rects.push(rect);
                    }
                    count++;
                }
                //count++;
            }
        }

    }
        function draw_rectangle_Acceleration(bounds, price) {
            var west = bounds.getWest();
            var east = bounds.getEast();
            var south = bounds.getSouth();
            var north = bounds.getNorth();
            var N = price.N;
            var width = 0.0011785999999997187 * N;//每N00m的经度差
            var length = 9.003999999997348E-4 * N;//每N00m的纬度差
            var r_min = price.r_min;
            var r_max = price.r_max;
            var c_min = price.c_min;
            var c_max = price.c_max;

            var row;
            var col;

            //将之前的图层删除
            if (rects.length != 0) {
                for (var i = 0; i < rects.length; i++) {
                    map = map.removeLayer(rects[i]);
                }
                rects = [];
            }

            var count = 0;
            for (row = r_min; row <= r_max; row++) {
                for (col = c_min; col <= c_max; col++) {

                    //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                    var dist_wid = (col - 1) * width;
                    var dist_len = (row - 1) * length;
                    var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                    var rect;
                    var gridvalue = price.data[count];

                    var gridcode_java = gridvalue.code;
                    var gridcode_js = col + (row - 1) * (2000 / N);

                    var gridcolor = gridvalue.color;
                    var gridrow = gridvalue.row;
                    var gridcol = gridvalue.col;
                    var acceleration = gridvalue.acceleration;

                    if (acceleration != 0) {
                        rect = L.rectangle(bounds, {
                            color: mycolor(255, 255, 255),
                            opacity: 0.9,
                            fillColor: gridcolor,
                            weight: 1,
                            fillOpacity: 0.6,
                            className: "" + gridcode_js + "," + row + "," + col
                        });//,className:gridcode_java
                        rect.index = count;
                        rect.data = price.data[rect.index];

                        rect.on('click', function (e) {
                            var json = {
                                "row": this.data.row,
                                "col": this.data.col,
                                "code": this.data.code,
                                "N": N
                            };

                            $.post("/price", JSON.stringify(json),
                                    function (data) {
                                        var ctx = document.getElementById("myChart").getContext("2d");
                                        pricedata = JSON.parse(data);

                                        var max = pricedata.suggestedMax;
                                        var min = pricedata.suggestedMin;

                                        var grid = JSON.stringify(json);
                                        var gridinfo = JSON.parse(grid);
                                        var info = "编码：" + gridinfo.code + "," + gridinfo.row + "行" + gridinfo.col + "列";
                                        window.myLine = new Chart(ctx, dataStruct(pricedata, info, max, min));
                                        $('#myModal').modal();
                                    }
                            )
                        });

                        rect.addTo(map);
                        rects.push(rect);
                    }
                    count++;
                }
            }

        }
        function draw_rectangle_interpolation(price) {
        var N = price.N;
        var width = 0.0011785999999997187 * N;//每N00m的经度差
        var length = 9.003999999997348E-4 * N;//每N00m的纬度差
        var r_min = price.r_min;
        var r_max = price.r_max;
        var c_min = price.c_min;
        var c_max = price.c_max;

        var row;
        var col;

        //将之前的图层删除
        if (rects.length != 0) {
            for (var i = 0; i < rects.length; i++) {
                map = map.removeLayer(rects[i]);
            }
            rects = [];
        }

        var count = 0;
        for (row = r_min; row <= r_max; row++) {
            for (col = c_min; col <= c_max; col++) {

                var gridcode_js = col + (2000 / N) * (row - 1);
                //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                var dist_wid = (col - 1) * width;
                var dist_len = (row - 1) * length;
                var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                var rect;
                var gridvalue = price.data[count];
                var gridcode_java = gridvalue.code;
                var gridcolor = gridvalue.color;
                var gridrow = gridvalue.row;
                var gridcol = gridvalue.col;
                var averageprice = gridvalue.average_price;

                if (gridcode_js == gridcode_java) {
                    if (averageprice != 0) {
                        //console.log(count);
                        rect = L.rectangle(bounds, {
                            color: mycolor(255, 255, 255),
                            opacity: 0.9,
                            fillColor: gridcolor,
                            weight: 1,
                            fillOpacity: 0.6,
                            className: "" + gridcode_java
                        });//,className:gridcode_java
                        rect.index = count;
                        rect.data = price.data[rect.index];

                        rect.on('click', function (e) {
                            var json = {
                                "row": this.data.row,
                                "col": this.data.col,
                                "code": this.data.code,
                                "N": N
                            };

                            $.post("/price", JSON.stringify(json),
                                    function (data) {
                                        var ctx = document.getElementById("myChart").getContext("2d");
                                        pricedata = JSON.parse(data);

                                        var max = pricedata.suggestedMax;
                                        var min = pricedata.suggestedMin;

                                        var grid = JSON.stringify(json);
                                        var gridinfo = JSON.parse(grid);
                                        var info = "编码：" + gridinfo.code + "," + gridinfo.row + "行" + gridinfo.col + "列";
                                        window.myLine = new Chart(ctx, dataStruct(pricedata, info, max, min));
                                        $('#myModal').modal();
                                    }
                            )
                        });

                        rect.addTo(map);
                        rects.push(rect);
                    }
                    count++;
                }
                //count++;
            }
        }

    }


        //插值数据网格绘制
        function draw_rectangle_houseprice_50(price) {
            var N = price.N;
            var width = 5.892999999998593E-4 * N;//每N50m的经度差
            var length = 4.501999999998674E-4 * N;//每N50m的纬度差
            var r_min = price.r_min;
            var r_max = price.r_max;
            var c_min = price.c_min;
            var c_max = price.c_max;

            var row;
            var col;

            //将之前的图层删除
            if (rects.length != 0) {
                for (var i = 0; i < rects.length; i++) {
                    map = map.removeLayer(rects[i]);
                }
                rects = [];
            }

            var count = 0;
            for (row = r_min; row <= r_max; row++) {
                for (col = c_min; col <= c_max; col++) {

                    //parseInt:取整数部分
                    //Math.ceil():只要有小数就加1
                    var cols=parseInt(4000 / N);
                    var gridcode_js = col +  cols* (row - 1);
                    //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                    var dist_wid = (col - 1) * width;
                    var dist_len = (row - 1) * length;
                    var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                    var rect;
                    var gridvalue = price.data[count];
                    var gridcode_java = gridvalue.code;
                    var gridcolor = gridvalue.color;
                    var gridrow = gridvalue.row;
                    var gridcol = gridvalue.col;
                    var averageprice = gridvalue.average_price;

                    if (gridcode_js == gridcode_java) {
                        if (averageprice != 0) {
                            //console.log(count);
                            rect = L.rectangle(bounds, {
                                color: mycolor(255, 255, 255),
                                opacity: 0.9,
                                fillColor: gridcolor,
                                weight: 1,
                                fillOpacity: 0.6,
                                className: "" + gridcode_java
                            });//,className:gridcode_java
                            rect.index = count;
                            rect.data = price.data[rect.index];

                            rect.on('click', function (e) {
                                var json = {
                                    "row": this.data.row,
                                    "col": this.data.col,
                                    "code": this.data.code,
                                    "N": N
                                };

                                $.post("/pricecurve_50", JSON.stringify(json),
                                        function (data) {
                                            var ctx = document.getElementById("myChart").getContext("2d");
                                            pricedata = JSON.parse(data);

                                            var max = pricedata.suggestedMax;
                                            var min = pricedata.suggestedMin;

                                            var grid = JSON.stringify(json);
                                            var gridinfo = JSON.parse(grid);
                                            var info = "编码：" + gridinfo.code + "," + gridinfo.row + "行" + gridinfo.col + "列";
                                            window.myLine = new Chart(ctx, dataStruct(pricedata, info, max, min));
                                            $('#myModal').modal();
                                        }
                                )
                            });

                            rect.addTo(map);
                            rects.push(rect);
                        }
                        count++;
                    }
                }
            }

        }
        function draw_rectangle_Acceleration_50(bounds, price) {
            var N = price.N;
            var width = 5.892999999998593E-4 * N;//每N50m的经度差
            var length = 4.501999999998674E-4 * N;//每N50m的纬度差
            var r_min = price.r_min;
            var r_max = price.r_max;
            var c_min = price.c_min;
            var c_max = price.c_max;

            var row;
            var col;

            //将之前的图层删除
            if (rects.length != 0) {
                for (var i = 0; i < rects.length; i++) {
                    map = map.removeLayer(rects[i]);
                }
                rects = [];
            }

            var count = 0;
            for (row = r_min; row <= r_max; row++) {
                for (col = c_min; col <= c_max; col++) {

                    //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                    var dist_wid = (col - 1) * width;
                    var dist_len = (row - 1) * length;
                    var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                    var rect;
                    var gridvalue = price.data[count];

                    var gridcode_java = gridvalue.code;
                    var gridcode_js = col + (row - 1) * (4000 / N);

                    var gridcolor = gridvalue.color;
                    var gridrow = gridvalue.row;
                    var gridcol = gridvalue.col;
                    var acceleration = gridvalue.acceleration;

                    if (acceleration != 0) {
                        rect = L.rectangle(bounds, {
                            color: mycolor(255, 255, 255),
                            opacity: 0.9,
                            fillColor: gridcolor,
                            weight: 1,
                            fillOpacity: 0.6,
                            className: "" + gridcode_js + "," + row + "," + col
                        });//,className:gridcode_java
                        rect.index = count;
                        rect.data = price.data[rect.index];

                        rect.on('click', function (e) {
                            var json = {
                                "row": this.data.row,
                                "col": this.data.col,
                                "code": this.data.code,
                                "N": N
                            };

                            $.post("/pricecurve_50", JSON.stringify(json),
                                    function (data) {
                                        var ctx = document.getElementById("myChart").getContext("2d");
                                        pricedata = JSON.parse(data);

                                        var max = pricedata.suggestedMax;
                                        var min = pricedata.suggestedMin;

                                        var grid = JSON.stringify(json);
                                        var gridinfo = JSON.parse(grid);
                                        var info = "编码：" + gridinfo.code + "," + gridinfo.row + "行" + gridinfo.col + "列";
                                        window.myLine = new Chart(ctx, dataStruct(pricedata, info, max, min));
                                        $('#myModal').modal();
                                    }
                            )
                        });

                        rect.addTo(map);
                        rects.push(rect);
                    }
                    count++;
                }
            }

        }
        function draw_rectangle_investment_50(price) {
            var N = price.N;
            var width = 5.892999999998593E-4 * N;//每N50m的经度差
            var length = 4.501999999998674E-4 * N;//每N50m的纬度差
            var r_min = price.r_min;
            var r_max = price.r_max;
            var c_min = price.c_min;
            var c_max = price.c_max;

            var row;
            var col;

            //将之前的图层删除
            if (rects.length != 0) {
                for (var i = 0; i < rects.length; i++) {
                    map = map.removeLayer(rects[i]);
                }
                rects = [];
            }

            var count = 0;
            for (row = r_min; row <= r_max; row++) {
                for (col = c_min; col <= c_max; col++) {

                    //parseInt:取整数部分
                    //Math.ceil():只要有小数就加1
                    var cols=parseInt(4000 / N);
                    var gridcode_js = col +  cols* (row - 1);
                    //网格是从左至右一行一行地填充，故对于某一固定的行，每个网格距离初始网格的经度跨度一直在变，而纬度跨度不变
                    var dist_wid = (col - 1) * width;
                    var dist_len = (row - 1) * length;
                    var bounds = [[39.438283 + dist_len, (115.417284 + dist_wid)], [(39.438283 + length) + dist_len, ((115.417284 + width) + dist_wid)]];//(左下角，右上角)
                    var rect;
                    var gridvalue = price.data[count];
                    var gridcode_java = gridvalue.code;
                    var gridcolor = gridvalue.color;
                    var gridrow = gridvalue.row;
                    var gridcol = gridvalue.col;
                    var averageprice = gridvalue.average_price;

                    if (gridcode_js == gridcode_java) {
                        if (averageprice != 0) {
                            //console.log(count);
                            rect = L.rectangle(bounds, {
                                color: mycolor(255, 255, 255),
                                opacity: 0.9,
                                fillColor: gridcolor,
                                weight: 1,
                                fillOpacity: 0.6,
                                className: "" + gridcode_java
                            });//,className:gridcode_java
                            rect.index = count;
                            rect.data = price.data[rect.index];

                            rect.on('click', function (e) {
                                var json = {
                                    "row": this.data.row,
                                    "col": this.data.col,
                                    "code": this.data.code,
                                    "N": N
                                };

                                $.post("/gridinfo", JSON.stringify(json), function (data) {

                                    $('#infoModal').modal();
                                    var information = JSON.parse(data);
                                    var house_type=information.house_type;
                                    tableAssignment(house_type,'house_type');
                                    var direction=information.direction;
                                    tableAssignment(direction,'direction');
                                    var floors=information.floors;
                                    tableAssignment(floors,'floors');
                                    var flooron=information.flooron;
                                    tableAssignment(flooron,'flooron');
                                    var area=information.area;
                                    tableAssignment(area,'area');
                                    var price=information.price;
                                    tableAssignment(price,'totalprice');
                                    var unitprice=information.unitprice;
                                    tableAssignment(unitprice,'unitprice');
                                  }
                                )
                            });

                            rect.addTo(map);
                            rects.push(rect);
                        }
                        count++;
                    }
                }
            }

        }
    function changeText(){
        document.getElementById('text2').innerHTML = 'Fred Flinstone Fred Flinstone Fred Flinstone Fred Flinstone';
        document.getElementById('text3').innerHTML = 'Fred Flinstone Fred FlinstoneFred FlinstoneFred FlinstoneFred FlinstoneFred Flinstone';
    }

        resize();

        //生成随机颜色和尺度
        var randomScalingFactor = function() {
        return Math.round(Math.random() * 100);
        //return 0;
    };
        var randomColorFactor = function() {
        return Math.round(Math.random() * 255);
    };
        var randomColor = function(opacity) {
        return 'rgba(' + randomColorFactor() + ',' + randomColorFactor() + ',' + randomColorFactor() + ',' + (opacity || '.3') + ')';
    };
        var MONTHS = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

        //config：表格所需要的数据结构，设置为全局变量
        var config = {
            type: 'line',
            data: {
                labels: [["10","2015"],"11", "12",  ["1","2016"],"2", "3", "4", "5"],
                datasets: [{
                    label: "房天下",
                    data: [],
                    fill: false
                    //borderDash: [5, 5]  设置曲线的虚线间隔，若没有该属性则为实线
                },{
                    //hidden: true, hidden表示该曲线在可视化时被隐藏
                    label: '我爱我家',
                    data: [],
                    fill: false
                },{
                    label: '融合数据',
                    data: [],
                    fill: false
                    //borderDash: [5, 5]  设置曲线的虚线间隔，若没有该属性则为实线
                }]
            },
            options:{
                responsive: true,
                title:{
                    display: true,
                    text: "房价曲线图"
                },
                tooltips: {
                    mode: 'label',
                    callbacks: {
                    }
                },
                hover: {
                    mode: 'dataset'
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            show: true,
                            labelString: 'Month'
                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            show: true,
                            labelString: 'Value'
                        },
                        ticks: {
                            suggestedMin: 0,
                            suggestedMax: 15,
                        }
                    }]
                }
            }
        };
        //对config里的数据进行修改
        function dataStruct(parameter, code, max, min){
            //如果这里不设置为空，则导致后面的网格的曲线和前面的网格曲线一样
            config.data.datasets[0].data=[];
            config.data.datasets[1].data=[];
            config.data.datasets[2].data=[];
            var text= ""+ code;
            /*
            在全局的数据结构下已经设置好日期了
            //设置横轴的时间序列
            for(var i=0; i < parameter.data.length; i++){
                config.data.labels.push(parameter.data[i].date);
            }*/

            //设置房天下数据的dataset
            if(parameter.fang.data.length!=0){
                for(var i= 0; i< parameter.fang.data.length; i++){

                    var time_price=parameter.fang.data[i];
                    var date=time_price.date;
                    var average_price=time_price.average_price;
                    var j=arrayAssignment(date);
                    config.data.datasets[0].data[j]=average_price;
                }
            }

            //设置我爱我家数据的dataset
            if(parameter.woaiwojia.data.length!=0){
                for(var i=0; i < parameter.woaiwojia.data.length; i++){

                    var time_price=parameter.woaiwojia.data[i];
                    var date=time_price.date;
                    var average_price=time_price.average_price;
                    var j=arrayAssignment(date);
                    config.data.datasets[1].data[j]=average_price;

                }
            }

            //设置融合数据的dataset
            if(parameter.blend.data.length!=0){
                for(var i=0; i < parameter.blend.data.length; i++){
                    var time_price=parameter.blend.data[i];
                    var date=time_price.date;
                    var average_price=time_price.average_price;
                    var j=arrayAssignment(date);
                    config.data.datasets[2].data[j]=average_price;
                }
            }


            //设置曲线的最大和最小值
            config.options.scales.yAxes[0].ticks.suggestedMin=min;
            config.options.scales.yAxes[0].ticks.suggestedMax=max;
            //展示曲线对应的具体网格值
            config.options.title.text="房价曲线图（:"+ code+"）"; //给曲线随机赋颜色值
            for(var i=0; i<config.data.datasets.length; i++){

               /* 这是给每条曲线颜色随意赋值，之后有用
               config.data.datasets[i].borderColor = randomColor(1);
                //config.data.datasets[i].backgroundColor = randomColor(0.3);
                config.data.datasets[i].pointBorderColor = randomColor(0.7);
                config.data.datasets[i].pointBackgroundColor = randomColor(0.5);
                */
                config.data.datasets[i].pointBorderWidth = 1;
                if(i==0){
                    config.data.datasets[i].borderColor = mycolor(0,0,255);
                    config.data.datasets[i].pointBorderColor = mycolor(0,0,255);
                    config.data.datasets[i].pointBackgroundColor = mycolor(0,0,255);
                }
                if(i==1){
                    config.data.datasets[i].borderColor = mycolor(0,255,0);
                    config.data.datasets[i].pointBorderColor =  mycolor(0,255,0);
                    config.data.datasets[i].pointBackgroundColor =  mycolor(0,255,0);
                }
                if(i==2){
                    config.data.datasets[i].borderColor = mycolor(255,0,0);
                    config.data.datasets[i].pointBorderColor = mycolor(255,0,0);
                    config.data.datasets[i].pointBackgroundColor = mycolor(255,0,0);
                }

            }

            return config;
    }
        var rects=[];
        var pricedata;
        function arrayAssignment(date){
            var i;

            if(date=="2015-10-01"){
                i=0;
            }else if(date=="2015-11-01"){
                i=1;
            }else if(date=="2015-12-01"){
                i=2;
            }else if(date=="2016-1-01"){
                i=3;
            }else if(date=="2016-2-01"){
                i=4;
            }else if(date=="2016-3-01"){
                i=5;
            }else if(date=="2016-4-01"){
                i=6;
            }else if(date=="2016-5-01"){
                i=7;
            }
            return i;
        }

        function mycolor(r,g,b) {
        var color= "rgb("+r+","+g+","+b+")";
        return color;
    }
        function poly_test() {
            latlngs = [];
            var latlng1 = L.latLng(39.906985851984146, 116.39055488416854);
            var latlng2 = L.latLng(39.905779, 116.319274);
            var latlng3 = L.latLng(39.88311876796353, 116.30383565962735);
            var latlng4 = L.latLng(39.872028939237744, 116.36803340806715);
            var latlng6 = L.latLng(39.906985851984146, 116.39055488416854);
            latlngs.push(latlng1);
            latlngs.push(latlng2);
            latlngs.push(latlng3);
            latlngs.push(latlng4);
            latlngs.push(latlng6);
            var poly = new L.Polygon(latlngs, {
                color: mycolor(0, 0, 205),
                fillColor: mycolor(0, 0, 205),
                stroke: true,
                weight: 1
            });
            map.addLayer(poly);
            polygon_array.push(poly);
            var content = "<DIV><span style=\"font-weight:bold;\"></span></DIV><HR/><DIV><span>" + "天安门" + "</span></DIV><BR/><DIV><span  style=\"font-weight:bold;\">位置:	</span> <span>" + "北京天安门" + "</span></DIV><DIV><span  style=\"font-weight:bold;\">类型:	</span><span>" + "文明古迹" + "<span></DIV>";
            var popup = L.popup()
                    .setLatLng(latlng1)
                    .setContent(content)
                    .openOn(map);
            poly.bindPopup(popup);
        }
        var legend = L.control({position: 'bottomright'});
        legend.onAdd = function (map) {

        var div = L.DomUtil.create('div', 'info legend'),
                color = ['#C70305', '#EA4706','#E97A04', '#E9A708', '#E6CC05', '#E9E507', '#D8EB00', '#B8E705', '#04E738','#06E884','#08E9C7','#03EAE4','#09BAEC','#077BEA', '#1411D2'], labels =[], grades=["[8,+∞]","[8,9]", "[7.5,8]","[7,7.5]","[6.5,7]","[6,6.5]", "[5.5,6]", "[5,5.5]","[4.5,5]","[4,4.5]", "[3.5,4]", "[3,3.5]", "[2.5,3]", "[2,2.5]","[0,2]"],
                from, to;

        for (var i = 0; i < color.length; i++) {
            labels.push(
                    '<i style=\"background:' +  color[i] + '\"></i> ' +grades[i]);
        }

        div.innerHTML = labels.join('<br>');
        return div;
    };
        legend.addTo(map);
        var gradeOptions = {

        weight: 1,
        fillOpacity: 0.7,
        rotation: 0.0,
        position: {
            x: 0,
            y: 0
        },
        offset: 0,
        innerRadius: 0,
    };
    //})

    //增删表格的行数
    var id=1;
    function add(text1,text2,table_id){

        id++;

        var theTable = document.getElementById(table_id);//table的id

        var rowCount = theTable.rows.length; //获得当前表格的行数

        var row = theTable.insertRow(rowCount);//在tale里动态的增加tr

        row.id=id;
        $("#"+id).attr("onmouseover","this.style.backgroundColor=\'#ffff66\';");
        $("#"+id).attr("onmouseout","this.style.backgroundColor=\'#C6E2FF\';");

        var cell1 = row.insertCell(0);//在tr中动态的增加td
        var cell2 = row.insertCell(0);//在tr中动态的增加td

        cell1.innerText=text1;
        cell1.style.cssText="text-align:center";     //tr中内容居中显示
        cell2.innerText=text2;
        cell2.style.cssText="text-align:center";     //tr中内容居中显示

    }
    function moveTr(tr_id,table_id){

        var tb=document.getElementById(table_id);   //获取table

        var tr=document.getElementById(tr_id);  //根据id获取具体的tr

        tb.deleteRow(tr.rowIndex);  //删除行

        unit(); //调用此方法，对界面有些地方的value进行更新
    }
    function tableAssignment(type,tableid) {
        var text;
        var text1;
        var text2;

        var texts=type.split(";");
        for (var m = 0; m < texts.length-1; m++) {
            text=texts[m].split(",");
            text1=text[1];
            text2=text[0];
            add(text1,text2,tableid);
        }
    }
</script>
</body>
</html>